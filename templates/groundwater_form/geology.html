{% load gwml2_forms %}
<div id="geology" class="tab-pane">
    <div class="section">
        <table>
            {% field_as_row form.total_depth %}
            <tr>
                <td><h4>Reference Elevation</h4></td>
            </tr>
            {% for field in reference_elevation %}
                {% field_as_row field %}
            {% endfor %}
        </table>
    </div>

    {% include "groundwater_form/_many-to-many.html" with id='geology_log' title='Geology Log' theform=geology_log %}
</div>
<script>
    submitFunctions['geology'] = function () {
        let data = {
            total_depth: $('#geology #id_total_depth').val(),
            reference_elevation: {},
            geology_log: submitFunctionsManyToMany['geology_log']()
        };
        {% for field in reference_elevation %}
            data['reference_elevation']['{{ field.name }}'] = $('#geology #{{ field.id_for_label }}').val()
        {% endfor %}
        return data;
    }
</script>